<Window x:Class="LTTPMusicReplacer.SpriteBrowserWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Browse Sprites"
        Icon="Resources/icon.ico"
        Width="820" Height="580"
        MinWidth="600" MinHeight="400"
        Background="{StaticResource BgBrush}"
        Foreground="{StaticResource TextBrush}"
        FontFamily="Segoe UI"
        WindowStartupLocation="CenterOwner"
        ShowInTaskbar="False">

    <DockPanel Margin="12">
        <!-- Search bar -->
        <DockPanel DockPanel.Dock="Top" Margin="0,0,0,10">
            <TextBlock Text="Search:"
                       VerticalAlignment="Center"
                       Margin="0,0,8,0"
                       Foreground="{StaticResource TextMutedBrush}"/>
            <TextBox x:Name="SearchBox"
                     Style="{StaticResource DarkTextBox}"
                     TextChanged="SearchBox_TextChanged"
                     VerticalAlignment="Center"/>
        </DockPanel>

        <!-- Bottom buttons -->
        <Border DockPanel.Dock="Bottom"
                Background="{StaticResource SurfaceBrush}"
                BorderBrush="{StaticResource BorderBrush}"
                BorderThickness="0,1,0,0"
                Padding="0,10,0,0"
                Margin="0,10,0,0">
            <DockPanel>
                <!-- Status text -->
                <TextBlock x:Name="StatusText"
                           VerticalAlignment="Center"
                           FontSize="12"
                           Foreground="{StaticResource TextMutedBrush}"/>

                <!-- Action buttons aligned right -->
                <StackPanel Orientation="Horizontal"
                            HorizontalAlignment="Right"
                            DockPanel.Dock="Right">
                    <Button Content="Cancel"
                            Style="{StaticResource DarkButton}"
                            Padding="16,6"
                            Margin="0,0,8,0"
                            Click="Cancel_Click"/>
                    <Button x:Name="SelectButton"
                            Content="Select Sprite"
                            Style="{StaticResource AccentButton}"
                            Padding="16,6"
                            IsEnabled="False"
                            Click="SelectSprite_Click"/>
                </StackPanel>
            </DockPanel>
        </Border>

        <!-- Main content: list + preview -->
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="300" MinWidth="180"/>
                <ColumnDefinition Width="5"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Sprite list -->
            <Border Grid.Column="0"
                    BorderBrush="{StaticResource BorderBrush}"
                    BorderThickness="1"
                    CornerRadius="6"
                    ClipToBounds="True">
                <Grid>
                    <!-- Loading overlay -->
                    <TextBlock x:Name="LoadingText"
                               Text="Loading sprites…"
                               HorizontalAlignment="Center"
                               VerticalAlignment="Center"
                               FontStyle="Italic"
                               Foreground="{StaticResource TextMutedBrush}"
                               Visibility="Visible"/>

                    <ListBox x:Name="SpriteList"
                             Background="{StaticResource SurfaceBrush}"
                             BorderThickness="0"
                             Foreground="{StaticResource TextBrush}"
                             SelectionChanged="SpriteList_SelectionChanged"
                             Visibility="Collapsed"
                             ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                        <ListBox.ItemContainerStyle>
                            <Style TargetType="ListBoxItem">
                                <Setter Property="Padding" Value="10,6"/>
                                <Setter Property="Background" Value="Transparent"/>
                                <Setter Property="BorderThickness" Value="0"/>
                                <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                                <Style.Triggers>
                                    <Trigger Property="IsSelected" Value="True">
                                        <Setter Property="Background" Value="{StaticResource AccentBrush}"/>
                                        <Setter Property="Foreground" Value="White"/>
                                    </Trigger>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="Background" Value="{StaticResource SurfaceAltBrush}"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </ListBox.ItemContainerStyle>
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <StackPanel>
                                    <TextBlock Text="{Binding Name}"
                                               FontWeight="SemiBold"
                                               FontSize="13"
                                               TextTrimming="CharacterEllipsis"/>
                                    <TextBlock Text="{Binding Author}"
                                               FontSize="11"
                                               Opacity="0.7"
                                               TextTrimming="CharacterEllipsis"/>
                                </StackPanel>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>
                </Grid>
            </Border>

            <!-- Splitter -->
            <GridSplitter Grid.Column="1"
                          Width="5"
                          HorizontalAlignment="Stretch"
                          Background="Transparent"/>

            <!-- Preview panel -->
            <Border Grid.Column="2"
                    Background="{StaticResource SurfaceBrush}"
                    BorderBrush="{StaticResource BorderBrush}"
                    BorderThickness="1"
                    CornerRadius="6"
                    Padding="16">
                <Grid>
                    <!-- Placeholder when nothing selected -->
                    <TextBlock x:Name="PreviewPlaceholder"
                               Text="Select a sprite to preview"
                               HorizontalAlignment="Center"
                               VerticalAlignment="Center"
                               FontStyle="Italic"
                               Foreground="{StaticResource TextFaintBrush}"
                               Visibility="Visible"/>

                    <!-- Preview content -->
                    <StackPanel x:Name="PreviewPanel"
                                VerticalAlignment="Center"
                                HorizontalAlignment="Center"
                                Visibility="Collapsed">
                        <!-- Sprite preview image -->
                        <Border Background="#1A1A24"
                                CornerRadius="4"
                                Padding="16"
                                Margin="0,0,0,12">
                            <Image x:Name="PreviewImage"
                                   Width="128" Height="128"
                                   Stretch="Uniform"
                                   RenderOptions.BitmapScalingMode="NearestNeighbor"/>
                        </Border>

                        <!-- Sprite name -->
                        <TextBlock x:Name="PreviewName"
                                   FontSize="15"
                                   FontWeight="SemiBold"
                                   Foreground="{StaticResource TextBrush}"
                                   HorizontalAlignment="Center"
                                   TextWrapping="Wrap"
                                   TextAlignment="Center"
                                   MaxWidth="220"/>

                        <!-- Sprite author -->
                        <TextBlock x:Name="PreviewAuthor"
                                   FontSize="12"
                                   Foreground="{StaticResource TextMutedBrush}"
                                   HorizontalAlignment="Center"
                                   Margin="0,4,0,8"/>

                        <!-- Tags -->
                        <WrapPanel x:Name="PreviewTags"
                                   HorizontalAlignment="Center"
                                   MaxWidth="240"/>
                    </StackPanel>

                    <!-- Loading indicator for preview -->
                    <TextBlock x:Name="PreviewLoadingText"
                               Text="Loading preview…"
                               HorizontalAlignment="Center"
                               VerticalAlignment="Center"
                               FontStyle="Italic"
                               Foreground="{StaticResource TextMutedBrush}"
                               Visibility="Collapsed"/>
                </Grid>
            </Border>
        </Grid>
    </DockPanel>
</Window>
